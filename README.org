# SPDX-FileCopyrightText: 2025-2026 Nikita Mitasov <me@ch4og.com>
# SPDX-License-Identifier: CC0-1.0

#+TITLE: AAGL on Guix
#+OPTIONS: toc:nil

#+HTML: <p><img src="logo.png" width="30%"/></p>

#+HTML: <a href="https://api.reuse.software/info/codeberg.org/ch4og/aagl-guix" rel="nofollow noopener"><img src="https://img.shields.io/reuse/compliance/codeberg.org%2Fch4og%2Faagl-guix?logo=open-source-initiative&label=REUSE&logoColor=white&labelColor=24292e"></a>
#+HTML: <a href="https://codeberg.org/ch4og/aagl-guix" rel="nofollow noopener"><img src="https://img.shields.io/badge/source-Codeberg-5993C8?logo=codeberg&logoColor=white&labelColor=24292e"></a>
#+HTML: <a href="https://gnu.org/software/guile/" rel="nofollow noopener"><img src="https://codeberg.org/luis-felipe/guile-graphics/raw/branch/trunk/badges/gnu-guile-made.svg"></a>

* Disclaimer

*** This project is *NOT* part of GNU Guix.
*** This channel includes packages that run proprietary software.

* Overview

AAGL on Guix provides Guix packages for [[https://github.com/an-anime-team/][an-anime-team]] launchers using an FHS-compatible container, similar to how Steam is packaged in [[https://gitlab.com/nonguix/nonguix][nonguix]].

* Usage

** Add This Channel

Add the channel to your ~channels.scm~ and pull:

#+BEGIN_SRC scheme
  (channel
    (name 'aagl)
    (url "https://codeberg.org/ch4og/aagl-guix.git")
    (branch "main")
    (introduction
     (make-channel-introduction
      "1055d880e124d69a2aef85cac98a813d442a55fa"
      (openpgp-fingerprint
       "7C9E 7EBA 828C 58DF DACE  5BED 4DCC 7AB7 FC75 319B"))))
#+END_SRC

Substitute server is currently WIP.

** Configure the hosts service

*For Guix System users:* Add ~aagl-hosts-service-type~ to your system configuration
to block telemetry servers. This is required for the launchers to work properly.
First time you will still get a warning that hosts blocking is required.

*For other distributions:* Launcher will attempt to configure hosts blocking
automatically. If this fails, follow the official documentation for your specific
launcher on blocking telemetry.

Guix System configuration example:

#+BEGIN_SRC scheme
  (use-modules (aagl services hosts))
  ;; or just (use-modules (aagl))

  (operating-system
    ;; ...
    (services
     (cons* (service aagl-hosts-service-type)
            ;; ...
            %desktop-services)))
#+END_SRC

** Using the packages

Load the module defining the packages, then add them to a manifest/configuration or just install.

- Module ~(aagl)~ provides all of the packages.

- Module ~(aagl packages honkers-railway)~ provides:
  - ~the-honkers-railway-launcher~
  - ~the-honkers-railway-launcher-nvidia~

- Module ~(aagl packages anime-game)~ provides:
  - ~an-anime-game-launcher~
  - ~an-anime-game-launcher-nvidia~

- Module ~(aagl packages sleepy)~ provides:
  - ~sleepy-launcher~
  - ~sleepy-launcher-nvidia~

- Module ~(aagl packages honkers)~ provides:
  - ~honkers-launcher~
  - ~honkers-launcher-nvidia~

* Sandboxing behavior

Launchers run inside an isolated FHS container. The container uses a *sandboxed HOME* directory:

=/home/<user>/.local/share/guix-sandbox-home/=

If you need to share a path to container, you can add it to =GUIX_SANDBOX_EXTRA_SHARES= environment variable.

* Acknowledgments

- [[https://github.com/ezKEa/aagl-gtk-on-nix][ezKEa/aagl-gtk-on-nix]] - reference implementation for Nix.
- [[https://gitlab.com/nonguix/nonguix][nonguix]] - Steam/FHS container mechanisms used as a base.
